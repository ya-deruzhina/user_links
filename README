# Django REST API User Links

## Installing
1. Clone the repository
2. Fill `.env` file based on `.env.example`  
3. Use command 'docker-compose up --build' in folder '/user_links/'

### !!! After installing Use next command in Docker Container
1. pipenv run seed all

### Or you can use command line in terminal
1. docker exec -it web pipenv run python manage.py migrate
2. docker exec -it web pipenv run python manage.py seed all

#The Swagger docs will be accessible on the `/doc` endpoint
http://127.0.0.1:8000/doc#/



######## SQL 
# For test SQL script Use next command in Docker Container:
1. psql -U postgres
2. \c links
3. 
SELECT u.email,
    COUNT(l) AS links_count,
    COUNT(CASE WHEN l.kind_link = 'WEBSITE' THEN 1 END) AS website,
    COUNT(CASE WHEN l.kind_link = 'BOOK' THEN 1 END) AS book,
    COUNT(CASE WHEN l.kind_link = 'ARTICLE' THEN 1 END) AS article,
    COUNT(CASE WHEN l.kind_link = 'MUSIC' THEN 1 END) AS music,
    COUNT(CASE WHEN l.kind_link = 'VIDEO' THEN 1 END) AS video
FROM users_user u
LEFT JOIN links_linksmodel l ON u.id = l.owner_id
GROUP BY u.email, u.created_at
ORDER BY links_count DESC, u.created_at ASC
LIMIT 10;